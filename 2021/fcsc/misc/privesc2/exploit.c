#include <unistd.h>
#include <stdlib.h>
#include <stdio.h>
#include <fcntl.h>
#include <sys/resource.h>

int main() {
	struct rlimit lim = { 0 };
	if (0 != getrlimit(RLIMIT_NOFILE, &lim))
	{
		puts("Meh");
		return 1;
	}
	printf("Hard/soft limits : %ld/%ld\n", lim.rlim_cur, lim.rlim_max);

	lim.rlim_cur = lim.rlim_max;
	if (0 != setrlimit(RLIMIT_NOFILE, &lim))
	{
		puts("w00t");
		return 2;
	}

	if (0 != getrlimit(RLIMIT_NOFILE, &lim))
	{
		puts("Meh");
		return 1;
	}
	printf("Hard/soft limits : %ld/%ld\n", lim.rlim_cur, lim.rlim_max);



	char flag_buf[256] = { 0 };
	int fd = open("/home/challenger/stage1/flag.txt", O_RDONLY);
	if (-1 == fd)
	{
		puts("Phuck");
		return 3;
	}

	int red = read(fd, flag_buf, sizeof(flag_buf));
	printf("%d bytes read : %s\n", red, flag_buf);

	return 0;
}
